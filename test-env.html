<!DOCTYPE html>
<html>
<head>
    <title>Environment Variables Test</title>
</head>
<body>
    <h1>Environment Variables Test</h1>
    <div id="results"></div>
    
    <script type="module">
        const results = document.getElementById('results');
        
        const env = {
            VITE_SUPABASE_URL: import.meta.env.VITE_SUPABASE_URL,
            VITE_SUPABASE_ANON_KEY: import.meta.env.VITE_SUPABASE_ANON_KEY,
            VITE_SUPABASE_SERVICE_ROLE_KEY: import.meta.env.VITE_SUPABASE_SERVICE_ROLE_KEY,
            VITE_USE_SERVICE_ROLE: import.meta.env.VITE_USE_SERVICE_ROLE
        };
        
        let html = '<h2>Environment Variables:</h2><ul>';
        
        for (const [key, value] of Object.entries(env)) {
            const status = value ? '✅' : '❌';
            const displayValue = value ? (value.length > 50 ? value.substring(0, 50) + '...' : value) : 'Not Set';
            html += `<li><strong>${key}:</strong> ${status} ${displayValue}</li>`;
        }
        
        html += '</ul>';
        
        // Test connection
        html += '<h2>Connection Test:</h2>';
        html += '<button onclick="testConnection()">Test Connection</button>';
        html += '<div id="connection-result"></div>';
        
        results.innerHTML = html;
        
        window.testConnection = async function() {
            const resultDiv = document.getElementById('connection-result');
            resultDiv.innerHTML = 'Testing...';
            
            try {
                const { createClient } = await import('@supabase/supabase-js');
                const supabase = createClient(env.VITE_SUPABASE_URL, env.VITE_SUPABASE_ANON_KEY);
                
                const { data, error } = await supabase.from('branches').select('count', { count: 'exact', head: true });
                
                if (error) {
                    resultDiv.innerHTML = `<p style="color: red;">❌ Error: ${error.message}</p>`;
                } else {
                    resultDiv.innerHTML = `<p style="color: green;">✅ Connection successful!</p>`;
                }
            } catch (err) {
                resultDiv.innerHTML = `<p style="color: red;">❌ Error: ${err.message}</p>`;
            }
        };
    </script>
</body>
</html>